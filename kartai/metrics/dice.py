import tensorflow as tf
K = tf.keras.backend

def dice_metric(y_true, y_pred):
    intersection = K.sum(K.sum(K.abs(y_true * y_pred), axis=-1))
    union = K.sum(K.sum(K.abs(y_true) + K.abs(y_pred), axis=-1))

    return 2*intersection / union
